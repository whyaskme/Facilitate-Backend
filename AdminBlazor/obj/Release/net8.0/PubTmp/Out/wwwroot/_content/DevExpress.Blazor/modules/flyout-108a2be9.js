import{_ as t}from"./_tslib-6e8ca86b.js";import{i,D as e,B as o,P as s,j as a,a as n,b as r,V as l,F as h,m as c,n as m}from"./popup-a1c2390a.js";import{P as d}from"./point-e4ec110e.js";import{b as u}from"./layouthelper-1d804c8c.js";import{y as f}from"./lit-element-70cf14f4.js";import{i as p}from"./query-44b9267f.js";import{e as g}from"./property-d3853089.js";import{e as b}from"./custom-element-267f9a21.js";import"./rafaction-bba7928b.js";import"./transformhelper-ebad0156.js";import"./positiontracker-d7595cd2.js";import"./constants-58283e53.js";import"./branch-bf06b0d2.js";import"./capturemanager-89a507c8.js";import"./eventhelper-8570b930.js";import"./dispatcheraction-19309c7b.js";import"./logicaltreehelper-99f1adf9.js";import"./portal-9686dca9.js";import"./data-qa-utils-8be7c726.js";import"./constants-058ebb50.js";import"./dx-html-element-pointer-events-helper-1bf230d1.js";import"./dom-e3fa5208.js";import"./browser-f8f6e902.js";import"./common-eb095e4d.js";import"./devices-9f03a976.js";import"./dx-ui-element-db9e89a3.js";import"./lit-element-base-7a85dca5.js";import"./nameof-factory-64d95f5b.js";import"./custom-events-helper-e7f279d3.js";import"./key-fa0d8a82.js";import"./dx-keyboard-navigator-38aff319.js";import"./focus-utils-6f61e33c.js";import"./touch-167bb2e4.js";import"./disposable-d2c2d283.js";import"./dom-utils-751497ba.js";import"./css-classes-f45f6949.js";var y,w;!function(t){t[t.TopStart=1]="TopStart",t[t.Top=2]="Top",t[t.TopEnd=4]="TopEnd",t[t.RightStart=8]="RightStart",t[t.Right=16]="Right",t[t.RightEnd=32]="RightEnd",t[t.BottomStart=64]="BottomStart",t[t.Bottom=128]="Bottom",t[t.BottomEnd=256]="BottomEnd",t[t.LeftStart=512]="LeftStart",t[t.Left=1024]="Left",t[t.LeftEnd=2048]="LeftEnd"}(w||(w={}));class P extends i{constructor(t,i,e,o,s,a){super(i,e,o,s,a),this.flyoutPosition=t}}const j="dxbl-flyout";let S=y=class extends e{get actualDistance(){var t;return null!==(t=this.flyoutDistance)&&void 0!==t?t:2}get actualOffset(){var t;return null!==(t=this.flyoutOffset)&&void 0!==t?t:0}get branchType(){return o.DropDown}constructor(){super(),this.slotChangedHandler=this.handleSlotChange.bind(this),this.dialog=null,this.flyoutDistance=null,this.flyoutOffset=null,this.calcStartAlignment=()=>0,this.calcEndAlignment=(t,i)=>i-t,this.calcAlignment=(t,i)=>i/2-t/2,this.placement=s.Custom,this.fitToRestriction=!0,this.flyoutPosition=0}get child(){return this.root}processCustomPlacement(t,i){return this.calcCustomPlacements(t,i)}calcCustomPlacements(t,i){const e=[];if(!this.dialog||!this.dialog.arrow)return e;const o=this.getBounds(i),s=this.getBounds(t),a=this.dialog.arrow.arrowSize;return this.flyoutPosition&w.Bottom&&e.push(this.calcBottomPlacement(o,a,this.calcAlignment(s.width,o.width),w.Bottom)),this.flyoutPosition&w.BottomStart&&e.push(this.calcBottomPlacement(o,a,this.calcStartAlignment(),w.BottomStart)),this.flyoutPosition&w.BottomEnd&&e.push(this.calcBottomPlacement(o,a,this.calcEndAlignment(s.width,o.width),w.BottomEnd)),this.flyoutPosition&w.Top&&e.push(this.calcTopPlacement(s,a,this.calcAlignment(s.width,o.width),w.Top)),this.flyoutPosition&w.TopStart&&e.push(this.calcTopPlacement(s,a,this.calcStartAlignment(),w.TopStart)),this.flyoutPosition&w.TopEnd&&e.push(this.calcTopPlacement(s,a,this.calcEndAlignment(s.width,o.width),w.TopEnd)),this.flyoutPosition&w.Left&&e.push(this.calcLeftPlacement(s,a,this.calcAlignment(s.height,o.height),w.Left)),this.flyoutPosition&w.LeftStart&&e.push(this.calcLeftPlacement(s,a,this.calcStartAlignment(),w.LeftStart)),this.flyoutPosition&w.LeftEnd&&e.push(this.calcLeftPlacement(s,a,this.calcEndAlignment(s.height,o.height),w.LeftEnd)),this.flyoutPosition&w.Right&&e.push(this.calcRightPlacement(o,a,this.calcAlignment(s.height,o.height),w.Right)),this.flyoutPosition&w.RightStart&&e.push(this.calcRightPlacement(o,a,this.calcStartAlignment(),w.RightStart)),this.flyoutPosition&w.RightEnd&&e.push(this.calcRightPlacement(o,a,this.calcEndAlignment(s.height,o.height),w.RightEnd)),e}calcLeftPlacement(t,i,e,o){const s=new d(-t.width-i.width-this.actualDistance,e+this.actualOffset);return new P(o,s,a.Horizontal,!0,n.Near,r.bottom)}calcTopPlacement(t,i,e,o){const s=new d(e+this.actualOffset,-t.height-i.height-this.actualDistance);return new P(o,s,a.Vertical,!0,n.Near,r.top)}calcRightPlacement(t,i,e,o){const s=new d(t.width+i.width+this.actualDistance,e+this.actualOffset);return new P(o,s,a.Horizontal,!1,n.Far,r.bottom)}calcBottomPlacement(t,i,e,o){const s=new d(e+this.actualOffset,t.height+i.height+this.actualDistance);return new P(o,s,a.Vertical,!1,n.Near,r.bottom)}processBestTranslationResults(t,i,e,o,s,a,n,r,l){if(super.processBestTranslationResults(t,i,e,o,s,a,n,r,l),!this.dialog||!this.dialog.arrow)return;const h=this.calcArrowAlignment(a,n,r);this.dialog.arrowAlignment=h;const c=this.dialog.arrow;c.position=this.getArrowPosition(c,i,e,o,r,null==l?void 0:l.flyoutPosition),c.alignment=h}getArrowPosition(t,i,e,o,s,n){const r=s===a.Vertical,h=r?t.arrowSize.width:t.arrowSize.height,c=u.rectToRange(e,r),m=u.rectToRange(i,r),d=u.rectToRange(o,r);let f=m.start,p=m.end;this.fitToRestriction&&(m.start<=d.start?(f=d.start,p=f+m.size):m.end>=d.end&&(f=d.end-m.size,p=f+m.size));const[g,b]=[Math.max(f,c.start),Math.min(p,c.end)];let y;y=n&(w.RightStart|w.RightEnd|w.LeftStart|w.LeftEnd)?c.start:c.start+c.size/2;const P=this.alignWithinBoundaries(y-h/2,g,b),j=this.calculateArrowOffsetFromEdge(c,h,m);return r?new l(Math.min(Math.max(P-f,j),i.width-j-h),0):new l(0,Math.min(Math.max(P-p,j-i.height),-j-h))}calcArrowAlignment(t,i,e){return e===a.Vertical?i===r.bottom?h.bottom:h.top:t===n.Near?h.start:h.end}alignWithinBoundaries(t,i,e){return i>=e?(i+e)/2:Math.min(Math.max(t,i),e)}calculateArrowOffsetFromEdge(t,i,e){const o=Math.min(t.size-i,t.size/2-i/2);return Math.max(y.DefaultArrowOffsetFromEdge,Math.min(o,.2*e.size))}renderTemplate(){return f`
            <dxbl-branch
                id="branch"
                branch-id="${this.branchId}"
                parent-branch-id="${this.parentBranchId}"
                type="${o.Flyout}">
                <dxbl-flyout-root
                    id="root"
                    style="${this.rootCssStyle}">
                    ${this.renderDefaultSlot()}
                    ${this.renderBridgeSlot()}
                </dxbl-flyout-root>
            </dxbl-branch>
        `}renderDefaultSlot(){return f`<slot @slotchange="${this.slotChangedHandler}"></slot>`}handleSlotChange(t){const i=t.target.assignedNodes();this.dialog=i.find((t=>t instanceof c)),this.dialog&&(this.dialog.animationEnabled=this.animationEnabled),this.reposition()}updated(t){super.updated(t),this.dialog&&t.has("animationEnabled")&&(this.dialog.animationEnabled=this.animationEnabled)}createKeyboardNavigationStrategy(){return new m(this.keyboardNavigator,this)}};S.DefaultArrowOffsetFromEdge=8,t([p("#root",!0)],S.prototype,"root",void 0),t([g({type:Number,attribute:"flyout-position"})],S.prototype,"flyoutPosition",void 0),t([g({type:Number,attribute:"flyout-distance"})],S.prototype,"flyoutDistance",void 0),t([g({type:Number,attribute:"flyout-offset"})],S.prototype,"flyoutOffset",void 0),S=y=t([b(j)],S);const E={DxFlyout:S,dxFlyoutTagName:j};export{P as CustomFlyoutPlacement,S as DxFlyout,w as FlyoutPosition,E as default,j as dxFlyoutTagName};
