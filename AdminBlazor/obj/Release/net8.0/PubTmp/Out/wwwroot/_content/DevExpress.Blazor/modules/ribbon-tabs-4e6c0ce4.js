import{_ as t}from"./_tslib-6e8ca86b.js";import{d as e}from"./dom-e3fa5208.js";import{S as i}from"./scroll-viewer-css-classes-6b178e01.js";import{T as o}from"./toolbar-css-classes-49e6b0a8.js";import{T as s,U as n}from"./constants-6cceb8d1.js";import{u as l,R as r,h as a,w as c,v as h,K as d,G as u,c as m,s as p,L as b}from"./dom-utils-751497ba.js";import{a as v,R as f}from"./layouthelper-1d804c8c.js";import{attachEventsForFocusHiding as S}from"./focus-utils-6f61e33c.js";import{S as g}from"./single-slot-element-base-4ab30292.js";import{e as T}from"./property-d3853089.js";import{e as C}from"./custom-element-267f9a21.js";import"./browser-f8f6e902.js";import"./common-eb095e4d.js";import"./css-classes-f45f6949.js";import"./point-e4ec110e.js";import"./constants-58283e53.js";import"./key-fa0d8a82.js";import"./touch-167bb2e4.js";import"./disposable-d2c2d283.js";import"./logicaltreehelper-99f1adf9.js";import"./data-qa-utils-8be7c726.js";import"./dx-ui-element-db9e89a3.js";import"./lit-element-base-7a85dca5.js";import"./lit-element-70cf14f4.js";var E,w;!function(t){t[t.None=0]="None",t[t.Back=1]="Back",t[t.Forward=2]="Forward"}(E||(E={}));class B{static calculate(t,e,i,o,s,n){const l=e?i.height:i.width,r=e?o.bottom:o.right,a=e?o.top:o.left,c=e?i.bottom:i.right,h=e?i.top:i.left,d=n?e?n.bottom:n.right:0,u=s?e?s.top:s.left:0;let m=a-h;switch(t){case E.Forward:m=Math.round(r-c),0===Math.round(m)&&n&&(m=Math.round(d-c)),m=Math.min(Math.max(0,m),l),0===m&&(m=l);break;case E.Back:m=Math.round(a)-Math.round(h),0===Math.round(m)&&s&&(m=Math.round(u-h)),m=-Math.min(Math.max(0,Math.abs(m)),l),0===m&&(m=-l);break;default:{const t=a<h,e=r>c;if(!t&&!e)return 0;if(e){const t=n?d-c:0;m=n&&a-t>=h?m=t:r-c}else if(t){const t=-a+h,e=s?-u+h:0;m=s&&r+e<=c?-e:r+t<=c?-t:0}break}}return Math.ceil(m)}}const k="data-dxtabs-tab-id",x="data-dxtabs-content-id",M=`.${s.Scrollable}`;var y,N,R,L;!function(t){t.Default="Default",t.AllTabs="AllTabs",t.OnDemand="OnDemand"}(y||(y={})),function(t){t.Auto="Auto",t.NavButtons="NavButtons",t.Swipe="Swipe",t.NoScroll="NoScroll"}(N||(N={})),function(t){t.Small="Small",t.Medium="Medium",t.Large="Large"}(R||(R={})),function(t){t.Top="Top",t.Bottom="Bottom",t.Left="Left",t.Right="Right"}(L||(L={}));const j="tab-count",D="scroll-mode",z="render-mode",I="active-tab",O="size-mode",U="tabs-position";let F=w=class extends g{constructor(){super(...arguments),this.mainElementContentWidthSubscription=null,this.contentPanelWidthSubscription=null,this.currentSize={width:null,height:null},this.contentSize={width:null,height:null},this.domChanges=[],this.scrollContainerElement=null,this.canTrackScroll=!1,this.tabCount=0,this.scrollMode=N.Auto,this.renderMode=y.Default,this.activeTab="",this.sizeMode=R.Medium,this.tabsPosition=L.Top,this.navElement=null,this.updateOverflowStateTimeout=0,this.minScrollStep=1,this.isReady=!1,this.neededCheckSize=!1,this.onScrollHandler=this.onScroll.bind(this),this.onNextButtonClickHandler=this.onScrollToNext.bind(this),this.onPrevButtonClickHandler=this.onScrollToPrev.bind(this),this.onClickHandler=this.onClick.bind(this),this.unsubscribeFocusUtils=null,this.unsubscribe=null}get isSideTabs(){return this.tabsPosition===L.Left||this.tabsPosition===L.Right}connectedOrContentChanged(){const t=this.querySelector(":scope > nav");t&&t!==this.navElement&&(this.navElement=t,this.dispose(),this.subscribeToEvents(),this.initialize(),this.isReady=!0)}disconnectedCallback(){super.disconnectedCallback(),this.disposeEvents(),this.dispose()}disposeEvents(){var t,e;null===(t=this.unsubscribe)||void 0===t||t.call(this),this.unsubscribe=null,null===(e=this.unsubscribeFocusUtils)||void 0===e||e.call(this),this.unsubscribeFocusUtils=null}subscribeToEvents(){if(!this.navElement)return;if(this.disposeEvents(),this.scrollMode!==N.NavButtons&&this.scrollMode!==N.Swipe)return;const t=this.getScrollContent();null==t||t.addEventListener("scroll",this.onScrollHandler),null==t||t.addEventListener("click",this.onClickHandler);const e=this.getPrevButton();null==e||e.addEventListener("click",this.onPrevButtonClickHandler);const i=this.getNextButton();null==i||i.addEventListener("click",this.onNextButtonClickHandler),this.unsubscribe=()=>{null==t||t.removeEventListener("scroll",this.onScrollHandler),null==t||t.removeEventListener("click",this.onClickHandler),null==e||e.removeEventListener("click",this.onPrevButtonClickHandler),null==i||i.removeEventListener("click",this.onNextButtonClickHandler)},this.unsubscribeFocusUtils=S(this.navElement)}dispose(){this.isReady=!1,this.updateOverflowStateTimeout&&(clearTimeout(this.updateOverflowStateTimeout),this.updateOverflowStateTimeout=0),this.mainElementContentWidthSubscription&&l(this.mainElementContentWidthSubscription),this.contentPanelWidthSubscription&&l(this.contentPanelWidthSubscription),this.neededCheckSize=!1}activate(t){if(!t)return;const e=document.querySelector(w.getSelector(k,t));if(null!=(null==e?void 0:e.parentNode)){const t=this.getListElement();for(let i=0;i<this.tabCount;i++)if(n.getChildByClassName(t.children[i],s.Item)===e){this.scrollToIndex(i);break}}}onScroll(t){this.updateOverflowState()}getContentElement(){return this.querySelector(`:scope > .${s.ContentPanel}`)}initialize(){r((()=>{this.prepareScrollMode(),e.DomUtils.addClassName(this.navElement,o.Loaded),this.checkForOverflow()})),this.mainElementContentWidthSubscription=a(this.navElement,(t=>{this.currentSize.width===t.width&&this.currentSize.height===t.height||(this.currentSize={width:t.width,height:t.height},this.checkForOverflow())}));const t=this.getContentElement();t&&(this.contentPanelWidthSubscription=a(t,(t=>{this.contentSize.width===t.width&&this.contentSize.height===t.height||(this.contentSize={width:t.width,height:t.height},this.onContentElementResize())})))}onContentElementResize(){this.updateSelectedContent()}updated(t){this.isReady&&((t.has("scrollMode")||t.has("tabCount")||t.has("sizeMode")||t.has("tabsPosition"))&&(r((()=>{this.prepareScrollMode(),this.checkForOverflow()})),this.subscribeToEvents()),t.has("activeTab")&&this.activate(this.activeTab),(t.has("renderMode")||t.has("activeTab"))&&this.updateSelectedContent(),super.updated(t))}queryUpdateOverflowState(t){this.updateOverflowStateTimeout&&clearTimeout(this.updateOverflowStateTimeout),this.updateOverflowStateTimeout=setTimeout((()=>{this.updateOverflowStateTimeout=0,this.updateOverflowState()}),t)}prepareScrollMode(){this.neededCheckSize=!!this.navElement&&this.scrollMode===N.NavButtons}checkForOverflow(){if(!this.neededCheckSize||!this.navElement)return;const t=this.isSideTabs?this.navElement.getBoundingClientRect().height-c(this.navElement):this.navElement.getBoundingClientRect().width-h(this.navElement);this.togleScrollState(t-this.calcNeededSize()<=-1)}togleScrollState(t){r((()=>{e.DomUtils.toggleClassName(this.navElement,s.HasOverflow,t),this.canTrackScroll=t,t&&this.queryUpdateOverflowState()}))}calcNeededSize(){var t;const e=null===(t=this.navElement)||void 0===t?void 0:t.getElementsByTagName("ul")[0];if(!e)return 0;let i=this.isSideTabs?c(e):h(e);const o=e.getElementsByTagName("li");for(const t of o)i+=this.isSideTabs?t.getBoundingClientRect().height+d(t):t.getBoundingClientRect().width+u(t);return i}updateOverflowState(){if(!this.canTrackScroll||this.scrollMode!==N.NavButtons)return;if(!this.findScrollContainer())return;const t=this.getScrollContent();if(!t)return;const[e,i]=this.getScrollAccess(t),o=this.getNextButton(),s=this.getPrevButton();m((()=>{o&&p(o,"disabled",!i),s&&p(s,"disabled",!e)}))}getScrollAccess(t){if(this.isSideTabs){const e=Math.ceil(t.scrollTop);return[e>0,Math.round(t.scrollHeight-e)-Math.round(t.clientHeight)>this.minScrollStep]}{const e=Math.ceil(t.scrollLeft);return[e>0,Math.round(t.scrollWidth-e)-Math.round(t.clientWidth)>this.minScrollStep]}}findScrollContainer(){if(!this.scrollContainerElement){if(!this.navElement)return null;this.scrollContainerElement=n.elementMatchesSelector(this.navElement,M)?this.navElement:this.navElement.querySelector(M)}return this.scrollContainerElement}getScrollContent(){return this.navElement?e.DomUtils.getNodesByClassName(this.navElement,i.ContentContainerClassName)[0]:null}getPrevButton(){var t;return null===(t=this.findScrollContainer())||void 0===t?void 0:t.querySelector(`:scope > .${s.ButtonScrollPrev}`)}getNextButton(){var t;return null===(t=this.findScrollContainer())||void 0===t?void 0:t.querySelector(`:scope > .${s.ButtonScrollNext}`)}onScrollToPrev(t){t.preventDefault();const e=this.findExtremeTabItemIndex(E.Back);this.scrollToIndex(e,E.Back)}onScrollToNext(t){t.preventDefault();const e=this.findExtremeTabItemIndex(E.Forward);this.scrollToIndex(e,E.Forward)}onClick(t){let e=t.target;for(;e;){if(b(e,s.Item)){const t=e.getAttribute(k);t&&this.activate(t);break}e=e.parentElement}}getListElement(){return this.navElement.getElementsByTagName("ul")[0]}getTabElement(t){return this.getListElement().querySelectorAll(":scope > li > ."+s.Item)[t]}scrollToIndex(t,e=E.None){var i,o;if(t>-1&&this.getScrollContent()){const s=t=>t.closest("li"),n=this.getTabElement(t),l=null===(i=s(n))||void 0===i?void 0:i.nextElementSibling,r=null===(o=s(n))||void 0===o?void 0:o.previousElementSibling;this.scrollToTab(n,r,l,e)}}findExtremeTabItemIndex(t){if(t===E.None)return-1;const e=this.getScrollContent();if(!e)return-1;const i=this.getListElement().querySelectorAll(":scope > li > ."+s.Item),o=this.getContentFrameRect(e),[n,l,r]=t===E.Forward?[0,this.tabCount,1]:[this.tabCount-1,-1,-1];for(let e=n;e!==l;e+=r){const s=i[e].getBoundingClientRect();if(this.isSideTabs){if(t===E.Back&&s.top<o.top||t===E.Forward&&s.bottom>o.bottom)return e}else if(t===E.Back&&s.left<o.left||t===E.Forward&&s.right>o.right)return e}return-1}getContentFrameRect(t){const i=e.DomUtils.getCurrentStyle(t),o=t.getBoundingClientRect();return new v(o.left+e.DomUtils.pxToInt(i.paddingLeft)+e.DomUtils.pxToInt(i.borderLeftWidth),o.top+e.DomUtils.pxToInt(i.paddingTop)+e.DomUtils.pxToInt(i.borderTopWidth),o.width-e.DomUtils.pxToInt(i.paddingRight)-e.DomUtils.pxToInt(i.borderRightWidth),o.height-e.DomUtils.pxToInt(i.paddingBottom)-e.DomUtils.pxToInt(i.borderBottomWidth))}scrollToTab(t,e,i,o){const s=this.getScrollContent();if(!s)return;const n=B.calculate(o,this.isSideTabs,this.getContentFrameRect(s),f.fromDomRect(t.getBoundingClientRect()),e?f.fromDomRect(e.getBoundingClientRect()):void 0,i?f.fromDomRect(i.getBoundingClientRect()):void 0);0!==n?this.isSideTabs?s.scrollTop+=n:s.scrollLeft+=n:s.scrollLeft>0&&o===E.Back&&(this.isSideTabs?s.scrollTop=0:s.scrollLeft=0)}updateSelectedContent(){const t=this.getContentElement();if(t){const i=this.activeTab?t.querySelector(w.getSelector(x,this.activeTab)):null,n=Array.from(t.querySelectorAll(`:scope > .${s.Content}${this.activeTab?`:not(${w.getSelector(x,this.activeTab)})`:""}`));r((()=>{if(i&&(i.style.cssText="",i.setAttribute("data-dx-tab-loaded","")),this.renderMode!==y.Default){const e=`position:absolute;visibility:hidden;left:-10000px;width:${t.clientWidth}px;height:${t.clientHeight}px`;n.forEach((t=>{t.style.cssText=e}))}t&&e.DomUtils.addClassName(t,o.Loaded)}))}}static getSelector(t,e){return`[${t}=${e}]`}};t([T({type:Number,attribute:j})],F.prototype,"tabCount",void 0),t([T({type:N,attribute:D})],F.prototype,"scrollMode",void 0),t([T({type:y,attribute:z})],F.prototype,"renderMode",void 0),t([T({attribute:I})],F.prototype,"activeTab",void 0),t([T({attribute:O})],F.prototype,"sizeMode",void 0),t([T({attribute:U})],F.prototype,"tabsPosition",void 0),F=w=t([C("dxbl-tabs")],F);const P={loadModule:function(){}};export{F as RibbonTabs,P as default};
